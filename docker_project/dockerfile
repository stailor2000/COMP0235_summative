# Use a Python base image
FROM python:3.8

# Install system dependencies
RUN apt-get update && apt-get install -y \
    wget \
    git \
    tar \
    # Any other system dependencies that might be necessary

# Install Python libraries
RUN pip install numpy pandas biopython scipy

# Clone the s4pred repository and download the model weights
RUN git clone https://github.com/psipred/s4pred /s4pred \
    && cd /s4pred \
    && wget http://bioinfadmin.cs.ucl.ac.uk/downloads/s4pred/weights.tar.gz \
    && tar -xvzf weights.tar.gz

# Download and install the static build of HH-suite
RUN wget https://github.com/soedinglab/hh-suite/releases/download/v3.3.0/hhsuite-3.3.0-SSE2-Linux.tar.gz \
    && tar xvfz hhsuite-3.3.0-SSE2-Linux.tar.gz \
    && mv hhsuite-3.3.0-SSE2-Linux /hhsuite \
    && echo "export PATH=/hhsuite/bin:/hhsuite/scripts:$PATH" >> ~/.bashrc

# Set environment variable for HH-suite path (adjust as necessary)
ENV PATH="/hhsuite/bin:/hhsuite/scripts:${PATH}"

# Add your application's source code to the Docker image
COPY /home/user/summative_work/docker_creations/ /app
WORKDIR /app

# Make your scripts executable
RUN chmod +x ./pipeline_script.py ./results_parser.py

# Command to run your application (adjust the command as per your requirement)
CMD ["python", "./pipeline_script.py", "input.fasta"]
